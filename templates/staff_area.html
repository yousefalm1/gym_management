{% extends 'base.html' %}
{% block content %}
    <h2>Staff Area</h2>
    <button id="showUsersBtn">Show Users</button>

    <div id="userList" style="display: none;">
        <h3>All Users</h3>
        <ul>
            {% for user in users %}
            <li>
                <strong>Username:</strong> {{ user.username }}<br>
                <strong>Email:</strong> {{ user.email }}<br>
                <strong>Registration Date:</strong> {{ user.date_joined|date:"F d, Y" }}<br>
                
                {% if user.instructorprofile %}
                    <strong> User Type:</strong> Instructor<br>
                {% else %}
                    <strong>User Type:</strong> Regular User<br>
                {% endif %}
                <a href="{% url 'delete_user' user.id %}">Delete</a><br>
                <a href="{% url 'edit_membership' user.id %}"> Edit Membership </a><br>
                <a href="{% url 'user_classes' user.id %}" > Classes Joined </a><br>
                <a href="{% url 'add_user_to_class' user.id %}" > Add to a Class</a>
            </li>
            {% endfor %}
        </ul>
    </div>



    <div>
        <button id="showClassesBtn" > Show Classes </button>
            <ul id="classList" style="display: none;">
                <h3> All Classes </h3>
                {% for gym_class in gym_classes %}
                <li>
                    <strong>{{gym_class.class_name}}</strong>
                    {% comment %} data-class-id to associate each "Show Users" button with a specific gym class  {% endcomment %}
                    <button class="showUsersBtn" data-class-id="{{ gym_class.class_id}}">Show Users</button>
                    <ul class="showUserList" style="display: none;">
                        {% comment %} iterate over the users in the class then displays them {% endcomment %}
                        {% for user_in_class in gym_class.users.all %}
                            <li>{{ user_in_class.username}}</li>
                        {% endfor %}
                    </ul>
                </li>
                {% endfor%}
            </ul>
    </div>

    <div>
        <a href="{% url 'create_instructor_profile' %}">
            <button>Create New Instructor Profile </button>
        </a>
    </div>

    <div>
        <a href="{% url 'create_gym_class' %}">
            <button>Create New Class </button>
        </a>
    </div>

   
    <script>
        document.getElementById('showUsersBtn').addEventListener('click', function () {
            document.getElementById('userList').style.display = (userList.style.display === 'none') ? 'block' : 'none';
        });

        document.getElementById('showClassesBtn').addEventListener('click', function () {
            var classList = document.getElementById('classList');
            classList.style.display = (classList.style.display === 'none' ) ? 'block' : 'none';
        });

    {% comment %} selects all the elements with the class 'showUsersBtn' and then stores it in the classButtons variable {% endcomment %}
    var classButtons = document.querySelectorAll('.showUsersBtn');

    {% comment %} iterates thru each classButtons {% endcomment %}
    {% comment %} then attaches a click event listener to each button {% endcomment %}
    {% comment %} 'button.nextElementSibling;' means when the user clicks the show users btn it will refer to the element under it  {% endcomment %}
    {% comment %} then it checks if the classlist style display is none it will change it to block to show the users and if the statement is false it will keep the none{% endcomment %}
    classButtons.forEach(function (button) {
        button.addEventListener('click', function () {

            var classUserList = button.nextElementSibling;

            classUserList.style.display = (classUserList.style.display === 'none') ? 'block' : 'none';
        });
    });

    </script>
{% endblock %}